<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MYNAH UI</title>
    <style>
      :root {
        --bg: #f2f4f1;
        --surface: #ffffff;
        --ink: #121814;
        --muted: #5a675f;
        --ok: #2a8f47;
        --down: #9b2c2c;
        --line: #dde3de;
      }
      body {
        margin: 0;
        background: radial-gradient(circle at 20% 20%, #e9efe9, var(--bg));
        color: var(--ink);
        font-family: "IBM Plex Sans", "Segoe UI", sans-serif;
      }
      main {
        max-width: 860px;
        margin: 2rem auto;
        padding: 1rem;
      }
      .panel {
        background: var(--surface);
        border: 1px solid var(--line);
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
      }
      h1, h2 {
        margin-top: 0;
      }
      .state-up { color: var(--ok); font-weight: 700; }
      .state-down { color: var(--down); font-weight: 700; }
      .muted { color: var(--muted); }
      code {
        background: #f6f8f7;
        border: 1px solid var(--line);
        padding: 0.1rem 0.3rem;
        border-radius: 6px;
      }
    </style>
  </head>
  <body>
    <main>
      <section class="panel">
        <h1>MYNAH Local UI Skeleton</h1>
        <p class="muted">Service: <code>{{ service }}</code></p>
        <p class="muted">UTC: {{ timestamp }}</p>
      </section>

      <section class="panel">
        <h2>Runtime Health</h2>
        <p>
          Pipeline Service:
          <span class="state-{{ pipeline_state }}">{{ pipeline_state }}</span>
          (<code>{{ pipeline_detail }}</code>)
        </p>
      </section>

      <section class="panel">
        <h2>Today HR Summary (UTC)</h2>
        <p>Samples: <code>{{ hr_today.sample_count if hr_today else "n/a" }}</code></p>
        <p>
          Min/Max/Avg BPM:
          <code>{{ hr_today.min_bpm if hr_today else "n/a" }}</code> /
          <code>{{ hr_today.max_bpm if hr_today else "n/a" }}</code> /
          <code>{{ hr_today.avg_bpm if hr_today else "n/a" }}</code>
        </p>
      </section>

      <section class="panel">
        <h2>Recent Voice Notes</h2>
        <p>Count: <code>{{ audio_recent.entries|length if audio_recent and audio_recent.entries else 0 }}</code></p>
        <p>
          Latest transcript-ready:
          <code>
            {% if audio_recent and audio_recent.entries %}
              {{ audio_recent.entries[0].transcript_ready }}
            {% else %}
              n/a
            {% endif %}
          </code>
        </p>
      </section>

      <section class="panel">
        <h2>Reports</h2>
        <p>Count: <code>{{ reports_recent.entries|length if reports_recent and reports_recent.entries else 0 }}</code></p>
        <p>
          Latest report date:
          <code>
            {% if reports_recent and reports_recent.entries %}
              {{ reports_recent.entries[0].report_date }}
            {% else %}
              n/a
            {% endif %}
          </code>
        </p>
      </section>
    </main>
  </body>
</html>
